<div class="row gx-5 justify-content-center">
    <div class="col-lg-8 col-xl-6">
        {{ form_start(form) }}
        <div class="form-floating mb-3">
            {{ form_widget(form.name) }}
            {{ form_label(form.name) }}
            <div class="invalid-feedback">
                {{ form_errors(form.name) }}
            </div>
        </div>
        <div class="form-floating mb-3">
            {{ form_widget(form.description) }}
            {{ form_label(form.description) }}
            <div class="invalid-feedback">
                {{ form_errors(form.description) }}
            </div>
        </div>

        <div>
            {{ form_label(form.groupes) }}
            {% for child in form.groupes %}
                <div class="form-check px-0">
                    {{ form_widget(child) }}
                    {{ form_label(child) }}
                </div>
            {% endfor %}
        </div>
        <h3 class="mt-3">Add some pictures</h3>
        <div class="mb-3">
            {{ form_label(form.images) }}
            {{ form_widget(form.images) }}
        </div>

        {# Anciennes images (edit uniquement) #}
        {% if figure is defined and figure.pictureFigures is not empty %}
            <h3>Existing pictures</h3>
            <div class="image-gallery">
                {% for image in figure.pictureFigures %}
                    <div class="image-item">
                        <img src="{{ asset('uploads/figures/' ~ image.name) }}" alt="" width="150"/>
                        <label>
                            Delete
                            <input type="checkbox" name="remove_images[]" value="{{ image.id }}">
                        </label>
                    </div>
                {% endfor %}
            </div>
        {% endif %}

        {# Ajout dynamique de vidéos #}
        <h3>Add some videos</h3>
        <div id="video-fields" class="row mb-3"
             data-prototype="{{ form_row(form.videoFigures.vars.prototype)|e('html_attr') }}">

            {% for videoUrl in form.videoFigures %}
                {{ form_row(videoFigures) }}
            {% endfor %}
        </div>
        <button type="button" id="add-video-field" class="btn btn-secondary mb-3">+ Add a video</button>

        {# Anciennes vidéos (edit uniquement) #}
        {% if figure is defined and figure.videoFigures is not empty %}
            <h3>Existing videos</h3>
            <ul>
                {% for video in figure.videoFigures %}
                    <li>
                        {{ video.embedUrl }}
                        <label>
                            Delete
                            <input type="checkbox" name="remove_videos[]" value="{{ video.id }}">
                        </label>
                    </li>
                {% endfor %}
            </ul>
        {% endif %}

        <button class="d-flex btn btn-primary">{{ button_label|default('Save') }}</button>
        {{ form_end(form) }}
    </div>
</div>


{# JavaScript pour ajout dynamique de vidéos #}
<script src="{{ asset('/js/figure-form.js') }}"></script>
